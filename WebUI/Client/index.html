<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Performance Monitor</title>
	
	<link rel="stylesheet" href="./css/bootstrap.min.css" media="screen">
	<link rel="stylesheet" href="./css/statcard.css" media="screen">
	<script type="text/javascript" src="./js/jquery.min.js"></script>
    <script type="text/javascript" src="./js/bootstrap.min.js"></script>
	<script type="text/javascript" src="./js/knockout.js"></script>
	<script type="text/javascript">
		var baseURL = "http://localhost:8000";
	</script>
	<script type="text/javascript" src="./js/perfmon_ko.js"></script>
</head>
<body>
	<div class="container-fluid">
		<header>
			<div class="dashhead">
				<div class="dashhead-titles">
					<h1 class="dashhead-title"></h1>
					<h3 class="dashhead-subtitle">Performance Monitor Charts and Reports</h3>
				</div>
			</div>
		</header>

		<div id="fltr" class="bkg-info p-a">
			<div id="fltr_Row" class="row justify-content-md-center">
				<div class="col-md">
					<label for="sel_Server" class="m-b-0">Server:</label>
					<select id="sel_Server" class="form-control form-control-sm m-b-10" 
						data-bind="options: lkpServers, optionsText: 'name', value: selectedServer"></select>
				</div>
				<div class="col-md">
					<label for="sel_MetricSet" class="m-b-0">Metric Set:</label>
					<select id="sel_MetricSet" class="form-control form-control-sm m-b-10"
						data-bind="options: lkpMetricSets, optionsText: 'name', value: selectedMetricSet"></select>
					<label for="sel_Metric" class="m-b-0">Metric:</label>
					<select id="sel_Metric" class="form-control form-control-sm m-b-10"
						data-bind="options: lkpMetrics, optionsText: 'name', value: selectedMetric"></select>
				</div>
				<div class="col col-lg-4">
					<div class="m-b">
						<label for="ctrRange_Dates" class="m-b-0">Date Range:</label><br>
						<input type="range" class="form-control-range" id="ctrRange_Dates" min="1" max="30" step="1" 
							data-bind="value: dateRangeDays">
						<div class="row muted">
							<div class="col-6">1 day</div>
							<div class="col-6 text-right">1 month</div>
						</div>
					</div>
					<div class="form-inline text-nowrap">
						<input type="date" id="dateStart" class="form-control form-control-sm" style="width:150px;" required>
						&nbsp;
						<input type="date" id="dateEnd" class="form-control form-control-sm" style="width:150px;" required>
					</div>
				</div>
				<div class="col col-md-2" style="vertical-align:bottom;">
					<a id="btnDashboard" href="javascript:;" onclick="getReport('dashboard', null, 'resDetail');" class="btn btn-warning w m-b-10" title="Shows 'out of ordinary' events for all servers for the last 2 days">Dashboard</a>
					<a id="btnWhySlow" href="" class="btn btn-warning w m-b-10" title="Shows 'out of ordinary' report for the selected Server">Why Slow?</a>
					<a id="btnGetChart" href="" class="btn btn-info w m-b-10" title="Plots chart for the selected Server and Metric">Get Chart</a>
				</div>
			</div>
		</div>

		<div id="res" class="m-t m-b">
			<div id="res_Hdr" class="hr-divider">
				<h3 id="resHeader" class="hr-divider-content hr-divider-heading">Results</h3>
			</div>
			<div id="resDetail" class="m-t">
			</div>
		</div>

		<div id="resStatus" class="muted">
			<div class="hr-divider m-t-md m-b">
				<h6 class="hr-divider-content hr-divider-heading">Execution log</h6>
			</div>
			<textarea class="form-control muted" disabled rows="5" id="txtStatus"></textarea>
		</div>
		
		<footer>
			<hr />
			<p class="muted">(c) 2018</p>
		</footer>
	</div>
	
	<div id='tooltip' class='tooltip' style='opacity:0;'></div>

	<script>
		$(document).ready(function(){
			// init dates
			var d = document.getElementById('dateEnd');
			d.value = getDateString(new Date());
			d = document.getElementById('dateStart');
			d.value = getDateString(new Date().addDays(-7));
			
			ko.applyBindings(viewModel);
		});
	</script>
	<script type="text/javascript" src="./js/perfmon_rpt.js"></script>
	<script type="text/javascript" src="./js/d3.min.js"></script>
</body>
</html>

